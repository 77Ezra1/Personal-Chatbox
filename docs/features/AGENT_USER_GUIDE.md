# AI Agent 功能使用指南

## 📖 **什么是 AI Agent？**

AI Agent 是一个智能助手系统，它可以：
- 🤖 **自动分解复杂任务** - 将大任务拆分成小步骤
- 🔄 **自主执行** - 按顺序完成每个子任务
- 📊 **实时反馈** - 显示执行进度和结果
- 🛠️ **调用工具** - 使用 Web 搜索、文件操作等工具

---

## 🚀 **快速开始（5 分钟）**

### 第 1 步：访问 Agent 页面

打开浏览器访问：
```
http://localhost:5173/agents
```

登录信息：
- 邮箱: test@example.com
- 密码: Aa123456!

---

### 第 2 步：创建你的第一个 Agent

#### 2.1 点击「创建 Agent」按钮

在 Agent 列表页面右上角，点击 **「+ 创建 Agent」** 按钮。

#### 2.2 填写基本信息

在弹出的对话框中填写：

**【基本信息】标签页**：
```
名称: 研究助手
描述: 帮助我进行信息研究和整理
类型: analytical (分析型)
```

#### 2.3 选择能力

**【能力】标签页**：
- ✅ Research（研究）
- ✅ Analysis（分析）
- ✅ Writing（写作）

可选的能力包括：
- **Research** - 信息搜索和研究
- **Data Processing** - 数据处理
- **Writing** - 文本生成
- **Analysis** - 数据分析
- **Automation** - 任务自动化

#### 2.4 高级配置（可选）

**【高级配置】标签页**：
```
AI 模型: gpt-4o-mini (默认)
Temperature: 0.7 (创造性，0-2之间)
Max Tokens: 4000 (最大输出长度)
系统提示词: 你是一个专业的研究助手，擅长信息搜集和分析...
```

**工具选择**：
- ✅ web_search (网页搜索)
- ✅ read_file (读取文件)
- ✅ data_transform (数据转换)

#### 2.5 点击「创建」

点击底部的 **「创建」** 按钮，Agent 就创建完成了！

---

### 第 3 步：执行任务

#### 3.1 找到刚创建的 Agent

在 Agent 列表中，找到「研究助手」卡片。

#### 3.2 点击「执行」按钮

卡片右下角有一个 **「▶ 执行」** 按钮，点击它。

#### 3.3 输入任务信息

在任务执行对话框中填写：

```
任务标题: 研究人工智能发展历史

任务描述: 
请帮我研究人工智能从诞生到现在的发展历程，
包括重要里程碑事件、关键人物和技术突破。

输入数据 (可选 JSON):
{
  "focus_areas": ["历史事件", "关键技术", "代表人物"],
  "time_range": "1950-2024"
}
```

#### 3.4 开始执行

点击 **「开始执行」** 按钮，任务开始运行！

#### 3.5 观察执行过程

你会看到：
- 📊 **进度条** - 显示完成百分比
- 📝 **子任务列表** - 显示每个步骤的状态
  - ⏳ 等待中（灰色）
  - ▶️ 执行中（蓝色，旋转动画）
  - ✅ 已完成（绿色）
  - ❌ 失败（红色）
- 📋 **执行日志** - 实时显示操作记录
- ⏱️ **执行时长** - 显示已用时间

#### 3.6 查看结果

任务完成后：
- 点击 **「结果」** 标签页查看最终输出
- 点击 **「子任务」** 查看每个步骤的详细结果
- 点击 **「日志」** 查看完整执行记录

---

## 🎨 **界面功能详解**

### Agent 列表页面

#### 1. 视图切换
- **网格视图** 🔲 - 卡片式展示（默认）
- **列表视图** ☰ - 紧凑列表展示

#### 2. 搜索和过滤
```
🔍 搜索框: 输入 Agent 名称或描述
📊 状态筛选: 全部 | 活跃 | 忙碌 | 离线
🏷️ 能力筛选: 点击能力标签过滤
```

#### 3. 排序选项
- 📝 按名称排序
- ⏰ 按最后运行时间
- 📈 按成功率
- 🔢 按总运行次数

#### 4. Agent 卡片信息
```
┌─────────────────────────────────┐
│ 🤖 研究助手         [状态徽章]  │
│ 专业的研究助手...               │
│                                 │
│ 🏷️ Research  Analysis  Writing │
│                                 │
│ 📊 统计:                        │
│    • 总运行: 15 次              │
│    • 成功率: 93%                │
│    • 上次运行: 2 小时前         │
│                                 │
│ [执行] [编辑] [删除] [...]      │
└─────────────────────────────────┘
```

#### 5. 操作菜单
- **执行** ▶️ - 立即执行任务
- **编辑** ✏️ - 修改 Agent 配置
- **查看详情** 👁️ - 查看完整信息
- **查看历史** 📜 - 查看执行记录
- **删除** 🗑️ - 删除 Agent

---

### 任务执行器界面

#### 1. 输入区域
```
┌─────────────────────────────────┐
│ 任务标题: [                   ] │
│ 任务描述:                       │
│ ┌─────────────────────────────┐ │
│ │                             │ │
│ │                             │ │
│ └─────────────────────────────┘ │
│                                 │
│ 输入数据 (JSON, 可选):          │
│ ┌─────────────────────────────┐ │
│ │ {                           │ │
│ │   "key": "value"            │ │
│ │ }                           │ │
│ └─────────────────────────────┘ │
│                                 │
│ [开始执行]                      │
└─────────────────────────────────┘
```

#### 2. 进度显示
```
━━━━━━━━━━━━━━━━━━━━━━━ 65%
正在执行: 分析研究数据
已用时间: 00:02:15
```

#### 3. 子任务列表
```
✅ 1. 搜索相关资料        (已完成)
✅ 2. 提取关键信息        (已完成)
▶️ 3. 分析研究数据        (执行中)
⏳ 4. 整理研究报告        (等待中)
⏳ 5. 生成摘要           (等待中)
```

#### 4. 执行日志
```
[INFO] 2025-10-23 21:30:00 - 任务开始执行
[INFO] 2025-10-23 21:30:05 - 开始分解任务
[SUCCESS] 2025-10-23 21:30:10 - 任务分解完成: 5个子任务
[INFO] 2025-10-23 21:30:15 - 执行子任务 1: 搜索相关资料
[SUCCESS] 2025-10-23 21:31:00 - 子任务 1 完成
[INFO] 2025-10-23 21:31:05 - 执行子任务 2: 提取关键信息
...
```

#### 5. 控制按钮
- **开始执行** ▶️ - 启动任务
- **停止执行** ⏹️ - 终止任务
- **重试** 🔄 - 重新执行失败的任务

---

## 💡 **使用场景示例**

### 场景 1: 信息研究 Agent

**配置**:
```
名称: 信息研究员
能力: Research, Analysis, Writing
工具: web_search, data_transform
```

**任务示例**:
```
标题: 分析竞品特性
描述: 研究市场上前3名竞品的核心功能和定价策略
输入: { "competitors": ["Product A", "Product B", "Product C"] }
```

**执行流程**:
1. 搜索每个竞品的官网信息
2. 提取产品功能列表
3. 整理定价信息
4. 对比分析优缺点
5. 生成分析报告

---

### 场景 2: 数据处理 Agent

**配置**:
```
名称: 数据分析师
能力: Data Processing, Analysis
工具: read_file, validate_data, data_transform
```

**任务示例**:
```
标题: 清洗销售数据
描述: 读取销售CSV文件，清洗异常数据，生成月度报表
输入: { "file_path": "data/sales.csv", "month": "2024-10" }
```

**执行流程**:
1. 读取CSV文件
2. 验证数据格式
3. 删除重复记录
4. 计算统计指标
5. 生成Excel报表

---

### 场景 3: 内容创作 Agent

**配置**:
```
名称: 内容创作者
能力: Writing, Research
工具: web_search, write_file
```

**任务示例**:
```
标题: 撰写技术博客
描述: 根据给定主题，研究资料并撰写一篇2000字的技术博客
输入: { "topic": "微服务架构最佳实践", "keywords": ["容器化", "API网关"] }
```

**执行流程**:
1. 搜索相关技术文章
2. 提取关键概念和案例
3. 构建文章大纲
4. 撰写各章节内容
5. 保存为Markdown文件

---

## 🔧 **高级功能**

### 1. 查看执行历史

点击 Agent 卡片的 **「📜 查看历史」**，可以看到：
- 所有历史任务列表
- 执行状态（成功/失败/取消）
- 执行时长
- 开始/结束时间
- 点击任务可查看详细结果和日志

### 2. 统计信息

在历史面板中可以看到：
```
总执行次数: 25
成功次数: 23
失败次数: 2
平均执行时长: 45 秒
成功率: 92%
```

### 3. 导出结果

任务完成后，点击 **「下载」** 按钮可以导出：
- JSON 格式的完整结果
- 包含所有子任务数据
- 执行日志和统计信息

### 4. 批量操作（计划中）

未来版本将支持：
- 批量执行多个任务
- 任务队列管理
- 定时任务调度

---

## 🎯 **最佳实践**

### 1. 创建 Agent 时
- ✅ **明确目标** - 给 Agent 一个清晰的用途
- ✅ **选对能力** - 只选择真正需要的能力
- ✅ **写好提示词** - 系统提示词要具体明确
- ✅ **合理配置** - Temperature 太高会不稳定，太低会死板

### 2. 执行任务时
- ✅ **任务描述清晰** - 越详细越好，包含具体要求
- ✅ **提供结构化输入** - 使用 JSON 格式输入复杂数据
- ✅ **实时监控** - 观察执行日志，及时发现问题
- ✅ **保存结果** - 重要结果及时下载保存

### 3. 优化性能
- ✅ **重复任务会被缓存** - 相同任务第2次执行会快很多
- ✅ **避免过于复杂的任务** - 太复杂的任务可以拆分
- ✅ **合理设置并发** - 同时执行太多任务会排队

---

## ⚠️ **常见问题**

### Q1: 为什么任务一直在排队？
**A**: 
- 当前全局并发限制为 10 个任务
- 如果有 10 个任务正在执行,新任务会排队等待
- 查看后端日志确认队列状态

### Q2: 任务执行失败怎么办？
**A**:
1. 查看执行日志找到错误信息
2. 检查 AI API 配置是否正确
3. 确认网络连接正常
4. 点击「重试」按钮重新执行

### Q3: 如何提高执行速度？
**A**:
- 使用更快的 AI 模型（如 gpt-3.5-turbo）
- 减少 Temperature 值（0.3-0.5）
- 简化任务描述
- 利用缓存机制（重复任务）

### Q4: Agent 能调用哪些工具？
**A**: 
当前可用工具：
- web_search - 网页搜索
- read_file - 读取文件
- write_file - 写入文件
- validate_data - 数据验证
- data_transform - 数据转换

### Q5: 怎么查看缓存命中率？
**A**:
查看后端日志：
```bash
tail -f logs/backend.log | grep "Cache"
```
会显示类似：`[Cache] Hit! 命中率: 45.00%`

---

## 📊 **性能指标**

当前优化后的性能：
- **最大并发**: 10 个任务同时执行
- **缓存命中速度**: 3-5 秒（vs 30-60 秒首次执行）
- **API 节省**: 30-50%（通过缓存）
- **平均任务时长**: 30-120 秒（取决于复杂度）

---

## 📚 **相关文档**

- [工作流程图](./AI_AGENT_WORKFLOW.md) - 了解系统如何运作
- [并发能力分析](./AI_AGENT_CONCURRENCY_ANALYSIS.md) - 了解性能限制
- [零成本优化方案](./ZERO_COST_OPTIMIZATION.md) - 提升性能的方法
- [优化实施报告](./OPTIMIZATION_REPORT.md) - 已完成的优化

---

## 🎉 **立即开始**

现在就打开浏览器访问：
```
http://localhost:5173/agents
```

创建你的第一个 AI Agent 吧！🚀

---

*最后更新: 2025-10-23*
*如有问题，请查看后端日志: `tail -f logs/backend.log`*
